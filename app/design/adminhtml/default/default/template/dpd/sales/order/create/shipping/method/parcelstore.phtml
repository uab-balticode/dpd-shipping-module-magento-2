<?php
/**
 * 2015 UAB BaltiCode
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License available
 * through the world-wide-web at this URL:
 * http://www.gnu.org/licenses/gpl-3.0.txt
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to info@balticode.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this module to
 * newer versions in the future.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2015 UAB Balticode (http://balticode.com/)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 * @see         Balticode_Dpd_Block_Adminhtml_Sales_Order_Create_Shipping_Method_Parcelstore
 */
?>
<?php if (count($this->getParcelStore())):?>
    <ul class="form-list" id="shipping_form_<?php echo $this->getRate()->getCode() ?>">
        <li>
            <div class="optgroup">
                <select name="dpd_delivery_id" class="" onChange="saveShippingMethodOptions(
                '<?php echo $this->getOrderSaveControllerUrl(); ?>', <?php echo $this->getQuoteValue('entity_id'); ?>, {ps:{dpd_delivery_id:this.value}});">
                    <option value='' data-comment=''>Please select a city</option>
                    <?php foreach ($this->getParcelStore() as $city => $data): ?>
                        <optgroup label="<?php echo $city; ?>">
                            <?php foreach ($data as $ps): ?>
                                <option value="<?php echo $ps['parcelshop_id'] ?>"
                                    <?php echo ($ps['parcelshop_id'] == $this->getCurrentValue())?' selected ':''?>
                                >
                                <?php echo $ps['company'];
                                    if ($this->showLongNames())
                                        echo $ps['street'];
                                ?>
                                </option>
                            <?php endforeach; ?>
                        </optgroup>
                    <?php endforeach; ?>
                </select>
            </div>
        </li>
    </ul>
<?php endif; ?>